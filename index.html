<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>แบบคำขอรับการสนับสนุนงบประมาณ</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: "Sarabun", sans-serif;
      padding: 40px;
      line-height: 1.8;
      max-width: 960px;
      margin: auto;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    .section {
      margin-top: 30px;
      padding: 20px;
      background-color: #f9f9f9;
    }
    .line {
      margin-top: 10px;
    }
    .line label {
      font-weight: bold;
      margin-right: 10px;
    }
    .line input, .line textarea, .line select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .checkbox-group {
      display: flex;
      flex-direction: column;
    }
    .checkbox-group label {
      font-size: 16px;
      margin-top: 10px;
    }
    input[type="checkbox"] {
      transform: scale(1.4);
      margin-right: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 6px;
      text-align: center;
      border: 1px solid #000;
    }
  </style>
</head>
<body>
  <h2>แบบคำขอรับการสนับสนุนงบประมาณ<br>โครงการสนับสนุน เสริมสร้าง ศักยภาพกองทุนหมู่บ้านและชุมชนเมืองอย่างมั่นคง</h2>

  <div class="container">
    <form id="budgetForm">
    <div class="section">
      <strong>คำชี้แจง:</strong> ให้กองทุนหมู่บ้านและชุมชนเมืองกรอกข้อมูลแบบคำขอรับการสนับสนุนงบประมาณโครงการ พร้อมทั้งแนบเอกสารประกอบให้ครบถ้วนสมบูรณ์ (สำหรับส่วนที่ 4 รายละเอียดโครงการสามารถจัดพิมพ์หรือดำเนินการในรูปแบบอื่น ๆ ตามความเหมาะสมได้ ทั้งนี้ จะต้องครอบคลุมเนื้อหาและรายละเอียดตามที่กำหนด โดยให้แนบมาพร้อมกับแบบ คสศ. 02)
    </div>

    <div class="section">
      <strong>ส่วนที่ ๑ ข้อมูลทั่วไป</strong>
      <div class="row mb-3">
        <div class="col-md-4"><label>1. กองทุนหมู่บ้าน/ชุมชนเมือง:</label></div>
        <div class="col-md-8"><input class="form-control" name="fund_name" /></div>
      </div>
      <div class="row mb-3">
        <div class="col-md-2"><label>เลขที่:</label></div>
        <div class="col-md-4"><input class="form-control" name="address_number" /></div>
        <div class="col-md-2"><label>ซอย:</label></div>
        <div class="col-md-4"><input class="form-control" name="soi" /></div>
      </div>
      <div class="row mb-3">
        <div class="col-md-2"><label>หมู่ที่:</label></div>
        <div class="col-md-4"><input class="form-control" name="moo" /></div>
        <div class="col-md-2"><label>ถนน:</label></div>
        <div class="col-md-4"><input class="form-control" name="road" /></div>
      </div>
      <div class="row mb-3">
        <div class="col-md-2"><label>ตำบล/แขวง:</label></div>
        <div class="col-md-4"><input class="form-control" name="subdistrict" /></div>
        <div class="col-md-2"><label>อำเภอ/เขต:</label></div>
        <div class="col-md-4"><input class="form-control" name="district" /></div>
      </div>
      <div class="row mb-3">
        <div class="col-md-2"><label>จังหวัด:</label></div>
        <div class="col-md-4"><input class="form-control" name="province" /></div>
        <div class="col-md-2"><label>เบอร์โทรศัพท์:</label></div>
        <div class="col-md-4"><input class="form-control" name="phone" /></div>
      </div>
      <div class="row mb-3">
        <div class="col-md-3"><label>2. มติประชุมประชาคม:</label></div>
        <div class="col-md-4">
          <input class="form-control" type="date" name="meeting_date" />
        </div>
      </div>
      
      <div class="row mb-3">
        <div class="col-md-6"><label>3. ได้รายงานงบการเงินล่าสุด 2 ปีต่อเนื่อง:</label></div>
        <div class="col-md-3"><input name="year_2566" type="checkbox"> ปี 2566</div>
        <div class="col-md-3"><input name="year_2567" type="checkbox"> ปี 2567</div>
      </div>
    </div>

    <div class="section">
      <strong>ส่วนที่ ๒ เอกสารประกอบการขอรับการสนับสนุนงบประมาณโครงการ (ให้ทำเครื่องหมาย ✓ ในช่อง)</strong>
      <div class="checkbox-group">
        <label><input name="doc1" type="checkbox"> สำเนาใบสำคัญแสดงการจดทะเบียนเป็นนิติบุคคล</label>
        <label><input name="doc2" type="checkbox"> รายงานงบการเงินปีล่าสุด 2 ปีต่อเนื่อง (2566, 2567)</label>
        <label><input name="doc3" type="checkbox"> แบบคำขอรับการสนับสนุนงบประมาณโครงการฯ</label>
        <label><input name="doc4" type="checkbox"> บันทึกรายงานการประชุม</label>
        <label><input name="doc5" type="checkbox"> รายชื่อผู้เข้าร่วมประชุม</label>
        <label><input name="doc6" type="checkbox"> รายชื่อคณะกรรมการและบันทึกประชุมคัดเลือก</label>
        <label><input name="doc7" type="checkbox"> ทะเบียนสมาชิกกองทุน</label>
        <label><input name="doc8" type="checkbox"> คำสั่งแต่งคณะผู้รับผิดชอบ</label>
        <label><input name="doc9" type="checkbox"> แผนการใช้จ่ายเงิน</label>
        <label><input name="doc10" type="checkbox"> สำเนาประกาศประชาสัมพันธ์</label>
      </div>
    </div>

    <div class="section">
      <strong>ส่วนที่ ๓ โครงการและงบประมาณ</strong>
    
      <div class="line row">
        <div class="col-md-6">
          <label>โครงการที่ 1:</label>
          <input class="form-control" name="project_1" />
        </div>
        <div class="col-md-6">
          <label>งบประมาณ:</label>
          <input class="form-control" name="budget_1" />
        </div>
      </div>
    
      <div class="line row">
        <div class="col-md-6">
          <label>โครงการที่ 2:</label>
          <input class="form-control" name="project_2" />
        </div>
        <div class="col-md-6">
          <label>งบประมาณ:</label>
          <input class="form-control" name="budget_2" />
        </div>
      </div>
    
      <div class="line row">
        <div class="col-md-6">
          <label>โครงการที่ 3:</label>
          <input class="form-control" name="project_3" />
        </div>
        <div class="col-md-6">
          <label>งบประมาณ:</label>
          <input class="form-control" name="budget_3" />
        </div>
      </div>
    
      <div class="line row">
        <div class="col-md-6">
          <label>โครงการที่ 4:</label>
          <input class="form-control" name="project_4" />
        </div>
        <div class="col-md-6">
          <label>งบประมาณ:</label>
          <input class="form-control" name="budget_4" />
        </div>
      </div>
    
      <div class="line row">
        <div class="col-md-6">
          <label>โครงการที่ 5:</label>
          <input class="form-control" name="project_5" />
        </div>
        <div class="col-md-6">
          <label>งบประมาณ:</label>
          <input class="form-control" name="budget_5" />
        </div>
      </div>
    </div>
    

    <div class="section">
      <strong>ส่วนที่ ๔ รายละเอียดโครงการ</strong>
      <div class="row mb-3">
        <div class="col-md-6">
          <label>1. โครงการ:</label>
          <input name="project_title" class="form-control" placeholder="ชื่อโครงการ">
        </div>
        <div class="col-md-6">
          <label>งบประมาณ:</label>
          <input name="project_total" class="form-control" placeholder="งบประมาณ" type="number">
        </div>
      </div>
      
      
      <div class="checkbox-group">
        <label><input type="checkbox" name="single_fund"> เป็นโครงการสำหรับกองทุนเดียว</label>
        <label><input type="checkbox" name="multiple_funds"> เป็นโครงการที่ร่วมกันมากกว่า 1 กองทุน (รวมจำนวน  กองทุน)</label>
        <label><input type="checkbox" name="all_funds"> เป็นโครงการที่ร่วมกันทุกกองทุนในตำบล (รวมจำนวน กองทุน)</label>
      </div>
      
      <label>กรณีร่วมกันมากกว่า 1 กองทุน ให้ระบุรายละเอียด:</label>
      <table class="table">
        <thead>
          <tr><th>ลำดับ</th><th>กองทุนหมู่บ้านทั้งหมด</th><th>งบแต่ละกองทุน</th><th>กิจกรรม/ทรัพย์สิน</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td><input name="fund_1" class="form-control"></td><td><input name="budget_1" class="form-control" type="number"></td><td><input name="activity_1" class="form-control"></td></tr>
          <tr><td>2</td><td><input name="fund_2" class="form-control"></td><td><input name="budget_2" class="form-control" type="number"></td><td><input name="activity_2" class="form-control"></td></tr>
          <tr><td>3</td><td><input name="fund_3" class="form-control"></td><td><input name="budget_3" class="form-control" type="number"></td><td><input name="activity_3" class="form-control"></td></tr>
          <tr><td>4</td><td><input name="fund_4" class="form-control"></td><td><input name="budget_4" class="form-control" type="number"></td><td><input name="activity_4" class="form-control"></td></tr>
          <tr><td>5</td><td><input name="fund_5" class="form-control"></td><td><input name="budget_5" class="form-control" type="number"></td><td><input name="activity_5" class="form-control"></td></tr>
          <tr><td>6</td><td><input name="fund_6" class="form-control"></td><td><input name="budget_6" class="form-control" type="number"></td><td><input name="activity_6" class="form-control"></td></tr>
          <tr><td>7</td><td><input name="fund_7" class="form-control"></td><td><input name="budget_7" class="form-control" type="number"></td><td><input name="activity_7" class="form-control"></td></tr>
          <tr><td>8</td><td><input name="fund_8" class="form-control"></td><td><input name="budget_8" class="form-control" type="number"></td><td><input name="activity_8" class="form-control"></td></tr>
          <tr><td>9</td><td><input name="fund_9" class="form-control"></td><td><input name="budget_9" class="form-control" type="number"></td><td><input name="activity_9" class="form-control"></td></tr>
          <tr><td>10</td><td><input name="fund_10" class="form-control"></td><td><input name="budget_10" class="form-control" type="number"></td><td><input name="activity_10" class="form-control"></td></tr>
        </tbody>
        
      </table>
      
      <label>2. วัตถุประสงค์:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="objective_1"> เพื่อพัฒนาโครงสร้างพื้นฐานและคุณภาพชีวิต</label>
        <label><input type="checkbox" name="objective_2"> เพื่อเพิ่มศักยภาพ สร้างรายได้ ลดรายจ่าย</label>
        <label><input type="checkbox" name="objective_3"> เพื่อสนับสนุนการพัฒนาด้านอาชีพ</label>
        <label><input type="checkbox" name="objective_4"> เพื่อสนับสนุนการดำเนินงานของกองทุนที่จำเป็นและเหมาะสม</label>
        <label><input type="checkbox" name="objective_5"> เพื่ออนุรักษ์สิ่งแวดล้อม</label>
      </div>
    
      <label>3. เหตุผลและความจำเป็น:</label>
      <textarea name="reason" class="form-control"></textarea>
    
      <label>4. เป้าหมาย:</label>
      <textarea name="goal" class="form-control"></textarea>
    
      <label>5. วิธีการดำเนินโครงการ:</label>
      <textarea name="method" class="form-control"></textarea>
    
      <label>6. การบริหารจัดการ:</label>
      <table class="table ">
        <thead>
          <tr><th>ลำดับ</th><th>แผนงาน/กิจกรรม</th><th>ผู้ที่เกี่ยวข้อง</th><th>ระยะเวลา</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td><input name="plan_1" class="form-control"></td><td><input name="person_1" class="form-control"></td><td><input name="duration_1" class="form-control"></td></tr>
          <tr><td>2</td><td><input name="plan_2" class="form-control"></td><td><input name="person_2" class="form-control"></td><td><input name="duration_2" class="form-control"></td></tr>
          <tr><td>3</td><td><input name="plan_3" class="form-control"></td><td><input name="person_3" class="form-control"></td><td><input name="duration_3" class="form-control"></td></tr>
          <tr><td>4</td><td><input name="plan_4" class="form-control"></td><td><input name="person_4" class="form-control"></td><td><input name="duration_4" class="form-control"></td></tr>
          <tr><td>5</td><td><input name="plan_5" class="form-control"></td><td><input name="person_5" class="form-control"></td><td><input name="duration_5" class="form-control"></td></tr>
          <tr><td>6</td><td><input name="plan_6" class="form-control"></td><td><input name="person_6" class="form-control"></td><td><input name="duration_6" class="form-control"></td></tr>
        </tbody>
        
      </table>
    
      <div class="line">
        <label>7. การใช้จ่ายเงิน:</label>
        <div class="d-flex align-items-center">
          <span>วงเงินงบประมาณที่ขอรับการสนับสนุนตามโครงการ  :  จำนวน</span>
          <input name="req_budget" class="form-control mx-2" type="number" placeholder="จำนวน" style="width: auto;">
          <span>บาท</span>
        </div>
      </div>
      <div class="line">
        <div class="d-flex align-items-center">
          <span>วงเงินงบประมาณที่ต้องการใช้ในการดำเนินโครงการ  :  จำนวน</span>
          <input name="needed_budget" class="form-control mx-2" type="number" placeholder="จำนวน" style="width: auto;">
          <span>บาท</span>
        </div>
      </div>
      <div class="line">
        <div class="d-flex align-items-center">
          <span>วงเงินงบประมาณที่จัดหาจากแหล่งอื่น</span>
          <input name="external_budget_source" class="form-control mx-2" type="text" placeholder="แหล่งอื่น" style="width: auto;">
          <span> : จำนวน</span>
          <input name="external_budget" class="form-control mx-2" type="number" placeholder="จำนวน" style="width: auto;">
          <span>บาท</span>
        </div>
      </div>
      
      <label>รายละเอียด:</label>
      <table class="table">
        <thead>
          <tr><th>ลำดับ</th><th>รายการ</th><th>จำนวนเงิน</th><th>ระยะเวลาดำเนินการ</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td><input name="item_1" class="form-control"></td><td><input name="amount_1" class="form-control" type="number"></td><td><input name="time_1" class="form-control"></td></tr>
          <tr><td>2</td><td><input name="item_2" class="form-control"></td><td><input name="amount_2" class="form-control" type="number"></td><td><input name="time_2" class="form-control"></td></tr>
          <tr><td>3</td><td><input name="item_3" class="form-control"></td><td><input name="amount_3" class="form-control" type="number"></td><td><input name="time_3" class="form-control"></td></tr>
          <tr><td>4</td><td><input name="item_4" class="form-control"></td><td><input name="amount_4" class="form-control" type="number"></td><td><input name="time_4" class="form-control"></td></tr>
          <tr><td>5</td><td><input name="item_5" class="form-control"></td><td><input name="amount_5" class="form-control" type="number"></td><td><input name="time_5" class="form-control"></td></tr>
          <tr><td>6</td><td><input name="item_6" class="form-control"></td><td><input name="amount_6" class="form-control" type="number"></td><td><input name="time_6" class="form-control"></td></tr>
        </tbody>
        
      </table>
      <br>
      <label>8. การดำเนินงานโครงการ:</label>
      <textarea name="operation" class="form-control"></textarea>
      <br>
      <label>9. การบริหารความเสี่ยง:</label>
      <textarea name="risk_mgmt" class="form-control"></textarea>
      <br>
      <label>10. การถือครองกรรมสิทธิ์:</label>
      <textarea name="ownership" class="form-control"></textarea>
      <br>
      <label>11. การใช้ประโยชน์:</label>
      <textarea name="benefit_use" class="form-control"></textarea>
      <br>
      <label>12. ความคุ้มค่าและความยั่งยืน:</label>
      <textarea name="sustain_value" class="form-control"></textarea>
    

      <br>
      <br>
      <br><br>
      <p>ขอรับรองว่าข้อมูลดังกล่าวข้างต้นเป็นไปตามโครงการของกองทุนหมู่บ้านและชุมชนเมืองทุกประการ</p>

      <div class="line row mb-3">
        <div class="col-md-2"><label>ลงชื่อ:</label></div>
        <div class="col-md-10"><input name="sign_name" class="form-control" placeholder="ผู้ขอรับการสนับสนุนงบประมาณฯ"></div>
      </div>
      
      <div class="line row mb-3">
        <div class="col-md-2"><label>ตำแหน่ง:</label></div>
        <div class="col-md-10"><input name="position" class="form-control" placeholder="ตำแหน่ง"></div>
      </div>
      
      <div class="line row mb-3">
        <div class="col-md-2"><label>วันที่:</label></div>
        <div class="col-md-10"><input name="sign_date" class="form-control" type="date"></div>
      </div>
      
      <div class="section">
        <button type="submit" class="btn btn-primary">ส่งข้อมูล</button>
      </div>
    </div>
  
  </form>
  <div id="status"></div>

  </div>
  
  <script type="text/javascript">
    function serializeFormData(formData) {
      const data = new URLSearchParams();
      for (const pair of formData.entries()) {
        data.append(pair[0], pair[1]);
      }
      return data.toString(); 
    }
  
   
    const form = document.getElementById('budgetForm');
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyHrU_gXvzwNytzYzm6iUBhQgGHbnensnSC79o6hCwm2Xl6buyOZ4-pV5vvdcZgaNTooQ/exec';
  
    form.addEventListener('submit', e => {
      e.preventDefault(); 
  
      const formData = new FormData(form);
      const serializedData = serializeFormData(formData); 
  
      console.log("Serialized Data: ", serializedData);  
  
      fetch(scriptURL, {
        method: 'POST',
        body: serializedData,
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded', 
        },
        credentials: 'same-origin', 
      })
      .then(response => {
        console.log("Response: ", response);  
        if (response.ok || response.redirected) {
          document.getElementById('status').innerText = "ส่งข้อมูลเรียบร้อยแล้ว!";
          form.reset();
        } else {
          document.getElementById('status').innerText = "เกิดข้อผิดพลาดในการส่งข้อมูล!";
        }
      })
      .catch(error => {
        console.log("Error: ", error);  
        document.getElementById('status').innerText = "ข้อผิดพลาด: " + error.message;
      });
    });
  </script>
  
  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  
</body>
</html>
